<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SubCategory</title>
    <script src="static/js/main.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.7.7/handlebars.min.js"></script>
    <link rel="stylesheet" href="static/css/styles.css">

</head>
<body>
    <div id="navWrap">
        <a href="./" id="linkWrap">
            <nav><span class="clean-a" >Home</span></nav>
        </a>
        <div class="messageContainer">
            <h3>Welcome</h3>
        </div>
    </div>
    <div class="marginMenuElement"></div>

    <script id="Subcategory-template" type="text/x-handlebars-template">
        <ul name="ads">
            {{#each ads}}
            <li name="categoryAd">
                <h2>{{title}}</h2>
                <p>{{description}}</p>
                <div class="gallery">
                {{#each images}}
                    <div class="imageFrame">
                        <img name="image" src="https://wiki-ads.onrender.com/{{this}}">
                    </div>
                {{/each}}
                </div>

                <p name="cost"> <b>{{cost}} â‚¬</b></p>
                <!--table - features-->
                <table name="specs">
                    <tr>
                        {{#each featuresArray}}
                            <td> {{this}} </td>
                        {{/each}}
                    </tr>
                </table>

            </li>
            {{/each}}
        </ul>
    </script>
    <script>
        //access to url params
        const urlParams = new URLSearchParams(window.location.search);
        const id = urlParams.get('id');
        getAdsFromSubCategory(id)
        .then(ads=>{
            // handlebars
            let templateSource = document.getElementById("Subcategory-template").innerHTML;
            let template = Handlebars.compile(templateSource);
            console.log(ads);
            // make data split is this the right kind of table?
            ads.forEach(ad=>{
                ad.featuresArray = ad.features.split(';');
            });
            console.log(ads);
            let data = {
                ads: ads
            };
            let html = template(data );
            document.body.innerHTML += html;
        });
        
    </script>
    
</body>
</html>